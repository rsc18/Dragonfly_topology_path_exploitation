import os
import multiprocessing as MP

#command = "python3 dragonflyv2.py -a 4 -g 5 -i 1"

def launchTest(a, g, i):
    outputFolderName = "Results_a16_h8_it1"
    os.makedirs(outputFolderName, exist_ok= True)    

    outputFileName = outputFolderName + "/" + "g_" + str(g)  + ".res"
    command = "python3 dragonflyv2.py -a {} -g {} -i {} > {} &".format(a,g,i,outputFileName)
         
            #-u option is needed to flush the output after each line
    print(command)
    os.system(command)


a = 16
iterations = 1
Gs = [9,17,41,71,89,129]
#Gs = [5]
processes = []

for g in Gs:
    p = MP.Process(target = launchTest, args = (a, g, iterations))
    processes.append(p)
    p.start()
    print("process started with a: {} g: {}  name: {} pid: {}".format(a, g ,p.name,p.pid))

#wait for all processes to finish
for p in processes:
   p.join()
